# 2단계: 추세 및 정배열 확인 (Trend Scanning)

## 개요
1단계에서 선정된 '활성 종목'들을 대상으로, 단기 추세가 살아있는지 확인합니다.
스캘핑/단타 매매에서는 거래량만큼이나 '현재 주가 방향'이 중요합니다.

## 목표
- **대상**: 1단계 필터링 통과 종목 (예: 거래대금 500억 이상)
- **데이터**: 1분봉(1-minute candles) 최근 100개
- **지표**: 5분, 20분, 60분 이동평균선 (SMA)
- **조건**: 정배열 (SMA 5 > SMA 20 > SMA 60) 및 이격도 확인

## 구현 상세

### 1. 캔들 데이터 조회
- `GET /v1/candles/minutes/1`
- 파라미터: `market` (종목코드), `count=100`

### 2. 이동평균선(SMA) 계산
- Pandas `rolling(window=N).mean()` 활용
- SMA 5: 최근 5분 평균
- SMA 20: 최근 20분 평균(볼린저 밴드 중심선 역할)
- SMA 60: 최근 60분(1시간) 평균

### 3. 필터링 조건
1.  **정배열 확인**: 현재 시점(또는 직전 봉) 기준 `SMA 5 > SMA 20 > SMA 60`
2.  **5이평 기울기 확인**: `SMA 5(현재) > SMA 5(1분 전)` (상승 추세 가속 확인)
3.  **이격도(Disparity) 고려**:
    - 이평선 간격이 너무 넓으면(이미 급등함) 제외 고려.
    - 막 정배열로 전환되었거나, 눌림목에서 반등하는 패턴 선호.

### 4. 파일 구조
- `src/myupbit01/trend.py`: 추세 분석 로직 모듈

## 실행 예시
```bash
poetry run python -m src.myupbit01.trend
```
결과:
```text
[정배열 포착]
- 비트코인 (KRW-BTC): 5선(9800) > 20선(9750) > 60선(9700)
- 리플 (KRW-XRP): ...
```
