# 자동 매매 로직 (Automated Trading Logic)

이 문서는 `src/myupbit01/trader.py`에 구현된 자동 매매 시스템의 상세 로직을 설명합니다.

## 1. 개요
- **목표**: 스코어링 시스템에서 포착된 급등주를 **지체 없이 매수**하여 단기 수익을 실현합니다.
- **특징**: 지정가 타임아웃 문제를 해결하기 위해 **시장가 진입**을 원칙으로 합니다.

## 2. 진입 전략 (Entry Strategy)
### A. 종목 선정
- `trend.py`의 공격적 스코어링 결과 상위 1위 종목을 선정.
- **진입 컷(Cut-line)**: 최소 점수 없음 (상대평가 1위), 단 0점일 경우 진입 자제 가능.

### B. 매수 실행 (Execution)
- **주문 방식**: **시장가 매수 (Market Buy Order)**
    - `pyupbit.buy_market_order(market, price)`
- **이유**: 급등주는 1~2초 사이에도 호가가 5% 이상 오를 수 있음. 지정가(Limit)로 1호가 아래에 걸면 **체결되지 않고 날아가는(Opportunity Cost)** 경우가 대부분이므로, 슬리피지를 감수하고 즉시 체결시킴.

## 3. 청산 전략 (Exit Strategy)
### A. 방어 (Defense)
- **급락 감지**: 5분봉 시가 대비 **-1.0%** 이상 급락 시 즉시 시장가 매도.
- **손절매 (Stop Loss)**: 진입가 대비 설정된 `STOP_LOSS` (기본 -2.0%) 도달 시 시장가 매도.

### B. 익절 (Take Profit)
- **트레일링 스탑 (Trailing Stop)**:
  - 목표 수익률(`PROFIT_TARGET`) 도달 시 감시 시작.
  - 고점(`highest_price`) 대비 일정 비율(`TRAILING_CALLBACK`) 하락 시 이익 실현.

### C. 물타기 (추매)
### C. 물타기 (추매)
- **조건**: 진입 15분 경과 && 수익률 -1.5% 이하.
- **필수 조건**: 현재 스코어 **20점 이상** (상승 모멘텀 유효 시에만 추매).
- **행동**: 위 조건 만족 시 1회 추가 매수(시장가)하여 평단가 낮춤.

## 4. 기타 시스템
- **쿨타임**: 매도 후 재진입 금지 시간 설정.
- **설정 파일**: `trader_config.json`에서 투자금, 익절/손절 비율 등 실시간 수정 가능.
