# 진입 전략 (Entry Strategy)

이 문서는 봇이 새로운 매수 대상을 선정하고 진입하는 전체 과정을 설명합니다.
진입 과정은 크게 **1단계: 유니버스 필터링 (Universe Filtering)**과 **2단계: 추세 스코어링 (Trend Scoring)**으로 나뉩니다.

---

## 1단계: 유니버스 필터링 (Universe Filtering)

### 개요
업비트의 전 종목 중 거래대금이 충분하고, **실질적인 가격 변동이 있는** '활성 종목'을 1차적으로 선별합니다.
수익 기회가 없는 스테이블 코인이나 횡보하는 거대 종목(노이즈)을 제거하는 것이 핵심입니다.

### 필터 조건
1. **유동성 (Top 30)**: 24시간 거래대금 기준 상위 30개 종목.
2. **Blacklist 제외**: `USDT` (테더), `XAUT` (테더골드), `USDC` 등 스테이블/자산형 코인 제외.
3. **최소 변동성 (Minimum Volatility)**: 전일 대비 등락률 절대값이 **1.0% 이상**인 종목만 선정. (멈춰있는 종목 제외)

### 구현 상세 (`universe.py`)
- `pyupbit.get_tickers(fiat="KRW")`로 전체 조회 후 거래대금 정렬.
- 블랙리스트 필터링 및 변동성 체크 (`abs(signed_change_rate) < MIN_VOLATILITY` 제외).
- 최종 상위 30개 종목 티커 반환.

---

## 2단계: 추세 및 스코어링 (Scoring System)

### 개요
1차 선별된 유니버스 종목 내에서 **"지금 당장 급등하는"** 종목을 찾기 위해 공격적인 스코어링 시스템을 적용합니다.
안정성보다는 **즉각적인 시세 분출(Momentum)**에 가중치를 둡니다.

### 스코어링 기준 (Aggressive Scoring)

총점은 각 항목의 합산으로 계산되며, 점수가 높은 순으로 진입 우선순위를 가집니다.

| 항목 | 조건 | 배점 | 의미 |
|---|---|---|---|
| **Volume Spike** | **5분 거래량 > 직전 1시간 평균 × 3배** | **+20** | **수급 폭발 (가장 중요)**. 세력 진입 시그널. |
| **Buying Power** | **체결 매수 비율 ≥ 60%** (최근 20건) | **+10** | 압도적인 매수 우위. |
| | 체결 매수 비율 ≥ 55% | +5 | 매수 우위. |
| **Momentum** | **1분 등락률 ≥ +1.5%** | **+10** | 1분 급등주 (Vi 발동 직전 등). |
| **RSI Overbought** | **RSI(14) ≥ 70** | **+5** | 과매수 구간 진입 (강력한 추세 지속). |
| **Trend Align** | SMA 5 > SMA 20 (단기 정배열) | +5 | 기본적인 상승 추세 확인. |
| **Slope Up** | SMA 5 기울기 상승 | +5 | 추세 가속. |
| **ADX Strength** | ADX ≥ 25 | +3 | 추세장 여부. |
| **(NEW) Min Entry** | **총점 ≥ 30점** | - | **진입 최소 컷트라인 (기존 20 -> 30 상향)** |

### 구현 상세 (`trend.py`)
- **초단기 분석**: 1분봉(`minute1`) 데이터를 기반으로 RSI, Momentum, SMA를 계산.
- **거래량 분석**: 5분봉(`minute5`)을 조회하여 '현재 5분 거래량' vs '직전 12개(1시간) 평균' 비교.
- **호가/체결**: `requests`를 통해 업비트 `/v1/trades/ticks` (최근 체결 내역)를 직접 조회하여 매수/매도 비율(Buying Power) 계산.

---

## 실행 프로세스 요약
1. `trader.py`가 주기적으로 `trend.scan_trends()` 호출.
2. `scan_trends()`가 `universe.get_active_tickers()`를 호출하여 1차 후보군 확보.
3. 확보된 후보군에 대해 개별 기술적 지표 계산 및 스코어링.
4. 총점이 `MIN_ENTRY_SCORE` (30점) 이상인 종목 중 가장 점수가 높은 종목을 매수 대상으로 선정.
